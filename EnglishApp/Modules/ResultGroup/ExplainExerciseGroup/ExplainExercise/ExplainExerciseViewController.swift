//
//  ExplainExerciseViewController.swift
//  EnglishApp
//
//  Created Steve on 7/28/19.
//  Copyright © 2019 demo. All rights reserved.
//
//  Template generated by Juanpe Catalán @JuanpeCMiOS
//

import UIKit
import XLPagerTabStrip
import WebKit

class ExplainExerciseViewController: BaseViewController {

	var presenter: ExplainExercisePresenterProtocol?

    @IBOutlet weak var webView: WKWebView!
    
    var id: Int = 0
    var font = """
    <style>
    @font-face
    {
        font-family: 'Comfortaa';
        font-weight: normal;
        src: url(Comfortaa-Regular.ttf);
    }
    @font-face
    {
        font-family: 'Comfortaa';
        font-weight: bold;
        src: url(Comfortaa-Bold.ttf);
    }
    </style>
    """
    
    override func setUpViews() {
        super.setUpViews()
        self.presenter?.getExplainQuestion(id: id)
        webView.navigationDelegate = self
        webView.scrollView.delegate = self
    }
    
    override func setUpNavigation() {
        super.setUpNavigation()
        addBackToNavigation()
        setTitleNavigation(title: LocalizableKey.explain_question.showLanguage)
    }
}
extension ExplainExerciseViewController : ExplainExerciseViewProtocol {
    func reloadView() {
        if let explain = self.presenter?.explainQuestion?.explain {
            hideNoData()
            let _htmlString = self.font + #"<span style="font-family: 'Comfortaa'; font-weight: Regular; font-size: 14; color: black; text-align: justify">"# + explain + #"</span>"#
            webView.loadHTMLString(_htmlString, baseURL: Bundle.main.bundleURL)
        } else {
            showNoData()
        }
    }
}
extension ExplainExerciseViewController : IndicatorInfoProvider {
    func indicatorInfo(for pagerTabStripController: PagerTabStripViewController) -> IndicatorInfo {
        return IndicatorInfo(title: LocalizableKey.explain_solution.showLanguage)
    }
}

extension ExplainExerciseViewController : UIScrollViewDelegate {
    func viewForZooming(in scrollView: UIScrollView) -> UIView? {
        return nil
    }
}

extension ExplainExerciseViewController: WKNavigationDelegate {
    func webView(_ webView: WKWebView, didCommit navigation: WKNavigation!) {
         let jscript = "var meta = document.createElement('meta'); meta.setAttribute('name', 'viewport'); meta.setAttribute('content', 'width=device-width'); document.getElementsByTagName('head')[0].appendChild(meta);"
        webView.evaluateJavaScript(jscript)
    }
    func webView(_ webView: WKWebView, didFinish navigation: WKNavigation!) {
        webView.frame.size.height = 1
        webView.frame.size = webView.scrollView.contentSize
    }
}

